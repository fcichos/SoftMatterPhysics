{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Kinetics of Liquid–Liquid Unmixing\n",
    "If two liquids are brought together at a composition that is either unstable or metastable, they will phase separate. The kinetics of this phase separation can proceed in different ways.\n",
    "\n",
    "1. **Spinodal Decomposition** – In this case, thermal fluctuations will amplify density fluctuations. The material will diffuse “uphill” to the regions of higher concentration to yield phase separation. The boundaries of the two phases are blurred in this case. Spinodal decomposition is the process of phase separation in the unstable region.\n",
    "2. **Nucleation** – In the case of nucleation, a thermal fluctuation will create a nucleus of a critical size, which further grows in time. The nucleus has a sharp boundary with the other phase. Nucleation is the process of phase separation in the metastable region.\n",
    "\n",
    "We will treat both kinetic regimes separately.\n",
    "\n",
    "## Spinodal decomposition\n",
    "\n",
    "Based on Fick’s law, we know that the diffusion currents occur in the direction against a composition gradient, i.e., $J=-D∇\\phi$. The result of that diffusion process is an equal composition in the whole sample. For phase separation to happen, material needs to flow from regions of low concentration to regions of higher concentration, so in the direction of the composition gradient. Material transport is therefore not balancing composition gradients. In the section about the chemical potential, we learned that in an open system the chemical potential of all species is balanced. The chemical potential is given by\n",
    "\n",
    "\\begin{equation}\n",
    "\\mu=\\frac{\\mathrm dF}{\\mathrm d\\phi}|_{V,T}.\n",
    "\\end{equation}\n",
    "\n",
    "If now the second derivative of the free energy with respect to $\\phi$ is positive, the regions with larger $\\phi$ have larger free energy. Thus regions of lower concentration are favored by the free energy and the diffusion happens to be downhill as given also by Ficks law.\n",
    "If the second derivate of the free energy is, however, negative, then fluctuations in the composition will lower the free energy and, thus, the fluctuations will grow in strength. The fluctuations with different length scales will, however, not grow at the same rate.\n",
    "The spectrum of growth rates can be described by a phenomenological theory known as the Cahn–Hilliard equation, which is applied in many fields. To arrive at that equation, we need to describe the free energy in terms of composition gradients\n",
    "\n",
    "\\begin{equation}\n",
    "F=A\\int \\left [f_{0}(\\phi)+\\kappa \\left( \\frac{\\mathrm d\\phi}{\\mathrm dx}\\right)^2\\right]\\mathrm dx.\n",
    "\\end{equation}\n",
    "\n",
    "Here, $f_0$ is the free energy density, $A$ an area and $x$ a linear coordinate.\n",
    "To balance the chemical potentials we need to modify Ficks laws\n",
    "\n",
    "\\begin{eqnarray} \n",
    "J &=& -D\\frac{\\mathrm d\\phi}{\\mathrm dx},\\\\ \\frac{\\mathrm d\\phi}{\\mathrm dt} &=& -\\frac{\\mathrm dJ}{\\mathrm dx},\\\\ \\frac{\\partial\\phi}{\\partial t} &=& D\\frac{\\partial^{2}\\phi}{\\partial x^2} \n",
    "\\end{eqnarray}\n",
    "\n",
    "to an appropriate new law\n",
    "\n",
    "\\begin{equation}\n",
    "J=-M \\frac{\\mathrm d\\mu}{\\mathrm dx},\n",
    "\\end{equation}\n",
    "\n",
    "where $\\mu=\\mu_{\\rm A}-\\mu_{\\rm B}$ is the difference between the chemical potentials of $\\mathrm{A}$ and $\\mathrm{B}$. This is apparently a linear approximation.\n",
    "According to the definition of the chemical potential, we obtain\n",
    "\n",
    "\\begin{equation}\n",
    "\\mu=\\frac{\\mathrm d}{\\mathrm d\\phi}\\left [f_{0}(\\phi)+\\kappa \\left( \\frac{\\mathrm d\\phi}{\\mathrm dx}\\right)^2\\right]\n",
    "\\end{equation}\n",
    "\n",
    "from which follows\n",
    "\n",
    "\\begin{equation}\n",
    "\\mu=\\frac{\\mathrm{d}f_{0}}{\\mathrm d\\phi}+2\\kappa\\frac{\\mathrm d^2\\phi}{\\mathrm dx^2},\n",
    "\\end{equation}\n",
    "\n",
    "where it was applied that \n",
    "\n",
    "\\begin{equation}\n",
    "\\frac{\\mathrm{d}}{\\mathrm{d}\\phi}\\bigg(\\frac{\\mathrm{d}\\phi}{\\mathrm{d}x}\\bigg)^2=\\frac{\\mathrm{d}x}{\\mathrm{d}\\phi}\\frac{\\mathrm{d}}{\\mathrm{d}x}\\bigg(\\frac{\\mathrm{d}\\phi}{\\mathrm{d}x}\\bigg)^2=\\frac{\\mathrm{d}x}{\\mathrm{d}\\phi}\\cdot \\bigg(2\\frac{\\mathrm{d}\\phi}{\\mathrm{d}x}\\bigg)\\cdot\\frac{\\mathrm{d}}{\\mathrm{d}x}\\frac{\\mathrm{d}\\phi}{\\mathrm{d}x}=2\\frac{\\mathrm{d}^2\\phi}{\\mathrm{d}x^2}.\n",
    "\\end{equation}\n",
    "\n",
    "Inserting this into our modified Ficks law yields\n",
    "\n",
    "\\begin{equation}\n",
    "J=-M f_{0}^{''}\\frac{\\mathrm d\\phi}{\\mathrm dx}-2M\\kappa \\frac{\\mathrm d\\phi^{3}}{\\mathrm dx^3}\n",
    "\\end{equation}\n",
    "\n",
    "with $f_0^{''}=(\\mathrm{d}^2 f_0)/(\\mathrm{d}ϕ^2)$. Finally, inserting the above equation into the continuity equation yields\n",
    "\n",
    "\\begin{equation}\n",
    "\\frac{\\partial \\phi}{\\partial t}=M f_{0}^{''}\\frac{\\partial ^2\\phi}{\\partial x^2}+2M\\kappa \\frac{\\partial^4 \\phi}{\\partial x^4}.\n",
    "\\end{equation}\n",
    "\n",
    "This is the **Cahn–Hilliard** equation, which extends the diffusion equation for interacting species. The term in front of the second derivative yields an effective diffusion coefficient, i.e., $D_{\\rm eff}=M f_{0}^{''}$. While the coefficient $M$ (the Onsager coefficient) is always positive, the second derivative of the free energy density $f_0$ can be positive or negative. Inside the spinodal line, for example, the curvature of the free energy is negative. Following that, the effective diffusion coefficient is negative which allows for our uphill diffusion.\n",
    "The Cahn–Hilliard equation can be solved by a Fourier decomposition which yields\n",
    "\n",
    "\\begin{equation}\n",
    "\\phi(x,t)=\\phi_{0}+A\\cos(qx)\\exp\\left [ -D_{\\rm eff} q^{2}\\left (1+\\frac{2\\kappa q^{2}}{f_{0}^{''}}\\right ) t\\right ].\n",
    "\\end{equation}\n",
    "\n",
    "Here $q$ is a wavenumber defining the wavelength of the fluctuations. The exponent can be abbreviated by\n",
    "\n",
    "\\begin{equation}\n",
    "R(q)= -D_{\\rm eff} q^{2}\\left (1+\\frac{2\\kappa q^{2}}{f_{0}^{''}}\\right )\n",
    "\\end{equation}\n",
    "\n",
    "which is nothing else as an inverse time or a rate coefficient. It provides the relaxation rate for a specific wavenumber. This rate coefficient is positive up to a certain wavenumber $q_0$. All fluctuations with wavelengths larger than $λ_0=2π/q_0$ are amplified in time. The fastest-growing fluctuation is obtained at $q_{\\rm max}$. This wavenumber sets the length scale of the structures, which typically appear during the spinodal decomposition.\n",
    "\n",
    "## Nucleation\n",
    "Nucleation is the phenomenon of spontaneously generating a phase-separated volume by thermal fluctuations. By doing that, we create an interface between the two phases, which costs energy. We, therefore, have a first simple look at the interfacial energy.\n",
    "\n",
    "### Interfacial Tension\n",
    "If we have a system of two components A and B and those components do not mix but form an interface, then, due to the fact that both sorts of molecules repel each other, we have to spend energy to bring them together. The work done to create an interfacial area is\n",
    "\n",
    "\\begin{equation}\n",
    "W=F \\Delta x=\\gamma L \\Delta x,\n",
    "\\end{equation}\n",
    "\n",
    "where $γ$ denotes the interfacial energy. If work is done, this would require an energy exchange with a reservoir to keep the temperature constant. That, however, also means that the interfacial energy is a free energy per unit area rather than an internal energy. Interfacial energies may contain entropic contributions. In the case of a sharp interface, we can use the interaction parameter $χ$ and the molecular volume $v$ to show\n",
    "\n",
    "\\begin{equation}\n",
    "\\gamma=\\frac{1}{2v^{2/3}}(2\\epsilon_{\\rm AB}-\\epsilon_{\\rm AA}-\\epsilon_{\\rm BB})=\\frac{\\chi k_{\\rm B}T}{zv^{2/3}}.\n",
    "\\end{equation}\n",
    "\n",
    "## Nucleation\n",
    "If we have a liquid mixture now at a certain composition, which is in the metastable region, i.e., $(∂^2 F)/(∂ϕ^2 )>0$, all of the density fluctuations in our system are damped and the spinodal decomposition can not happen. Therefore, the system has to phase separate by nucleation, i.e., that spontaneously a droplet of a certain size is formed and grows further. As we need energy to create the interface but also gain free energy by forming a volume phase, we need to have a look at the total free energy change, when the droplet is formed.\n",
    "\n",
    "- the volume part is delivering a free energy gain per volume of $ΔF_v<0$, which has to be multiplied with the volume of the droplet.\n",
    "- the creation of an interface requires interfacial energy $γ$, which is always positive and has to be multiplied with the droplet surface area.\n",
    "\n",
    "Thus, the total free energy change reads\n",
    "\n",
    "\\begin{equation}\n",
    "\\Delta F(r)=\\frac{4}{3}\\pi r^3\\Delta F_{v}+4\\pi r^2 \\gamma.\n",
    "\\end{equation}\n",
    "\n",
    "Note, that the first term is negative as $ΔF_v$ is negative. A typical free energy change with the particle size is shown in the figure below. It has a maximum at the position $r^*$,which creates a nucleation barrier $ΔG^*$. Droplets which are spontaneously formed at $r<r^*$ can decrease their free energy by dissolving.\n",
    "\n",
    "![Download](img/download.png)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "tags": []
   },
   "source": [
    "<div class=\"alert alert-info\">\n",
    "\n",
    "**Liquid-Liquid Unmixing - Ouzo Effect**\n",
    "    \n",
    "One example of liquid-liquid unmixing by nucleation is the Ouzo or Louche effect. The name denotes the spontaneous formation of a turbid microemulsion when a solution of anethol in ethanol is diluted with water. The figure below shows the phase digram of this ternary mixture. \n",
    "    \n",
    "![Ouzo](img/ouzo.png)\n",
    "    \n",
    "When the emulsification happens, the solution rapidly moves to the metastable region between the binodal and spinodal lines. It occurs because the alcohol, as it diffuses from the anethol into the water, carries with it some of the anethol molecules that still have a finite solubility in alcohol and alcohol/water mixtures. As the alcohol diffuses further into the water, the associating anethol(oil) molecules become expelled from the water-rich solution and are stranded in the form of fine emulsion droplets. Thus, adding water to a solution of homogeneous oil/ethanol mixtures leads to an abrupt decrease of the solubility of oil in the water-rich continuous phase. This effect causes the strong local concentration fluctuations of solute molecules and homogeneous nucleation can start.\n",
    "    \n",
    "The image below shows the turbidity of the emulsion to appear as the water content is changed.    \n",
    "    \n",
    "![Ouzo1](img/ouzo_1.png) \n",
    "    \n",
    "    \n",
    "    \n",
    "The data has been taken from:   Sitnikova, N. L., Sprik, R., Wegdam, G. & Eiser, E. Spontaneously Formed trans-Anethol/Water/Alcohol Emulsions: Mechanism of Formation and Stability. Langmuir 21, 7083–7089 (2005).\n",
    "  \n",
    "    \n",
    "</div>"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.8.16"
  },
  "toc": {
   "base_numbering": 1,
   "nav_menu": {},
   "number_sections": true,
   "sideBar": true,
   "skip_h1_title": false,
   "title_cell": "Table of Contents",
   "title_sidebar": "Contents",
   "toc_cell": false,
   "toc_position": {},
   "toc_section_display": true,
   "toc_window_display": false
  },
  "widgets": {
   "application/vnd.jupyter.widget-state+json": {
    "state": {},
    "version_major": 2,
    "version_minor": 0
   }
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
